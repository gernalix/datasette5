{% extends "default:query.html" %}

{% block extra_body %}
  {{ super() }}
  <script>
    (function(){
      // Applica solo alla pagina /output/calendar_range
      if (!/\/output\/calendar_range(\/|$)/.test(location.pathname)) return;

      
      const hideSQL = () => {
        // Solo nascondi i blocchi di SQL che mostrano la definizione della view,
        // senza rimuovere intestazioni o intere sezioni (per non toccare "Referenced by").
        const rx = /CREATE\s+VIEW|AS\s+SELECT/i;
        document.querySelectorAll('pre, code').forEach(el => {
          const t = (el.textContent || '');
          if (rx.test(t)) {
            el.style.display = 'none';
          }
        });
        // Nascondi link "View and edit SQL" senza toccare altro
        Array.from(document.querySelectorAll('a, button')).forEach(el => {
          const txt = (el.textContent || '').trim().toLowerCase();
          if (txt === 'view and edit sql' || txt === 'view sql' || txt === 'sql') {
            el.style.display = 'none';
          }
        });
      };
    

      hideSQL();
      new MutationObserver(hideSQL).observe(document.body, { childList: true, subtree: true });
    })();
  </script>
{% endblock %}
